{% extends 'inventory/base_auth.html' %}
{% load static %}


{% block content_auth %}
<form method="post" novalidate id="kt_password_reset_form">
    {% csrf_token %}

    <!-- Heading -->
    <div class="text-center mb-4">
        <h2 class="text-dark fw-bold mb-3">Réinitialisation</h2>
        <div class="text-secondary small">
            Entrez votre email pour recevoir le lien de réinitialisation.
        </div>
    </div>

    <!-- Non-field errors -->
    {% if form.non_field_errors %}
    <div class="alert alert-danger d-flex align-items-center mb-4" role="alert">
        <i class="bi bi-exclamation-triangle-fill flex-shrink-0 me-2"></i>
        <div>{{ form.non_field_errors|join:", " }}</div>
    </div>
    {% endif %}

    <!-- Email Field -->
    <div class="form-floating mb-4">
        <input type="email" class="form-control" id="floatingEmail" 
               name="{{ form.email.name }}" placeholder="Email" autocomplete="off"
               value="{% if form.email.value %}{{ form.email.value }}{% endif %}">
        <label for="floatingEmail">Email</label>
        {% if form.email.errors %}
        <div class="text-danger mt-1 small">
            {{ form.email.errors.0 }}
        </div>
        {% endif %}
    </div>

    <!-- Actions -->
    <div class="d-grid gap-2">
        <button type="submit" id="kt_password_reset_submit" class="btn btn-lg btn-nature">
            <span class="indicator-label">Envoyer</span>
            <span class="indicator-progress d-none">Patientez...
                <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
            </span>
        </button>
        <a href="{% url 'inventory:login' %}" class="btn btn-lg btn-light border">
            Annuler
        </a>
    </div>
</form>

<script>
    document.getElementById('kt_password_reset_form').addEventListener('submit', function(e) {
        var btn = document.getElementById('kt_password_reset_submit');
        var label = btn.querySelector('.indicator-label');
        var progress = btn.querySelector('.indicator-progress');

        if(btn && label && progress){
            btn.setAttribute('disabled', 'disabled');
            label.classList.add('d-none');
            progress.classList.remove('d-none');
        }
    });
</script>
{% endblock %}
